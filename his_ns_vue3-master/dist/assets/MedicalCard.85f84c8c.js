import{f as le,p as S}from"./api.12427e84.js";import{_ as ae,r as s,l as te,s as I,b as n,c as oe,o as b,d as U,h as a,g as t,e as m,F as x,i as f,w as ue,f as N,t as M,p as R,y as re,m as D,E}from"./index.eaac7b27.js";const de={class:"search-controls"},ne={m:"4",style:{"padding-left":"50px"}},se={m:"t-0 b-2"},pe={m:"t-0 b-2"},ie={m:"t-0 b-2"},me={class:"dialog-footer"},fe={class:"dialog-footer"},ve={__name:"MedicalCard",setup(ge){const $=s(!1),v=s({}),k=s(""),q=s(10),L=[10,20,30,50],B=s(1),y=s(!1),c=s(!1),w=s(null),C=s(null),O=s([{value:181,label:"\u7A97\u53E3"},{value:182,label:"\u5FAE\u4FE1"},{value:183,label:"AndroidApp"},{value:184,label:"\u82F9\u679CApp"}]),J={id:"",realname:"",gender:"",idnumber:"",birthdate:"",phone:"",addr:"",cardtype:"",cardNo:"",channel:181},o=s(JSON.parse(JSON.stringify(J))),A=s({realname:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D",trigger:"blur"}],gender:[{required:!0,message:"\u8BF7\u9009\u62E9\u6027\u522B",trigger:"change"}],idnumber:[{required:!0,message:"\u8BF7\u8F93\u5165\u6709\u6548\u8EAB\u4EFD\u8BC1\u53F7\u7801",trigger:"blur"},{pattern:/^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,message:"\u8BF7\u8F93\u5165\u6709\u6548\u8EAB\u4EFD\u8BC1\u53F7\u7801",trigger:"blur"}],phone:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"\u8BF7\u8F93\u5165\u6709\u6548\u624B\u673A\u53F7",trigger:"blur"}],addr:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BB6\u5EAD\u4F4F\u5740",trigger:"blur"}],cardtype:[{required:!0,message:"\u8BF7\u9009\u62E9\u5C31\u8BCA\u5361\u7C7B\u578B",trigger:"change"}],cardNo:[{required:!0,message:"\u8BF7\u8F93\u5165\u533B\u4FDD\u5361\u53F7",trigger:"blur"}],birthdate:[{required:!0,message:"\u8BF7\u9009\u62E9\u51FA\u751F\u65E5\u671F",trigger:"change"}],channel:[{required:!0,message:"\u8BF7\u9009\u62E9\u6CE8\u518C\u6E20\u9053",trigger:"change"}]});te(async()=>{V(1)});async function V(r){$.value=!0;let e=`/medicalcard/page?count=${q.value}&pn=${r}`;k!=""&&(e+=`&keyword=${k.value}`);const u=await le(e,null);u.result?(v.value=u.data,$.value=!1):u.errMsg=="\u672A\u767B\u5F55"&&I.push("/login")}function X(r){V(r)}function j(r){c.value=!0;const e=typeof r.gender=="string"?r.gender==="\u7537"?71:72:r.gender;o.value={...r,gender:e}}function T(r){const e=r==="edit"?C.value:w.value;e&&e.resetFields(),o.value=JSON.parse(JSON.stringify(J))}async function G(){!C.value||await C.value.validate(r=>{r&&S("/medicalcard/update",o.value).then(e=>{e.data.result?(c.value=!1,V(v.value.current),D.success("\u4FEE\u6539\u6210\u529F")):D.error(e.data.errMsg||"\u4FEE\u6539\u5931\u8D25")})})}async function H(){!w.value||await w.value.validate(r=>{r&&S("/medicalcard/add",o.value).then(e=>{e.data.result?(y.value=!1,B.value=1,V(1),D.success("\u65B0\u589E\u6210\u529F")):D.error(e.data.errMsg||"\u65B0\u589E\u5931\u8D25")})})}function K(r){E.confirm("\u786E\u8BA4\u662F\u5426\u5220\u9664?","\u63D0\u9192",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{var e=new FormData;e.append("id",r),S("/medicalcard/del",e).then(u=>{u.data.result?(V(v.value.current),E.alert("\u5220\u9664\u6210\u529F","\u63D0\u793A",{})):(result.errMsg=="\u672A\u767B\u5F55"&&I.push("/login"),E.alert(u.data.errMsg,"\u63D0\u793A",{}))})})}return(r,e)=>{const u=n("el-input"),g=n("el-button"),F=n("el-row"),p=n("el-table-column"),Q=n("el-table"),Y=n("el-col"),W=n("el-pagination"),i=n("el-option"),_=n("el-select"),d=n("el-form-item"),z=n("el-form"),P=n("el-dialog"),Z=n("el-date-picker"),h=oe("loading");return b(),U(x,null,[a(F,{class:"search-bar"},{default:t(()=>[m("div",de,[a(u,{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=l=>k.value=l),modelModifiers:{trim:!0},placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D\u6216\u8EAB\u4EFD\u8BC1\u53F7\u7801"},null,8,["modelValue"]),a(g,{type:"primary",onClick:e[1]||(e[1]=l=>V(1))},{default:t(()=>e[29]||(e[29]=[f("\u67E5\u8BE2")])),_:1,__:[29]})]),a(g,{type:"primary",onClick:e[2]||(e[2]=l=>y.value=!0)},{default:t(()=>e[30]||(e[30]=[f("\u65B0\u589E\u7535\u5B50\u5C31\u8BCA\u5361")])),_:1,__:[30]})]),_:1}),e[37]||(e[37]=m("div",{style:{"margin-top":"40px"}},null,-1)),a(F,{class:"m-2"},{default:t(()=>[a(Y,{span:24},{default:t(()=>[ue((b(),N(Q,{data:v.value.records,style:{width:"100%"}},{default:t(()=>[a(p,{type:"expand"},{default:t(l=>[m("div",ne,[m("p",se,"\u5BB6\u5EAD\u5730\u5740: "+M(l.row.addr),1),m("p",pe,"\u6CE8\u518C\u65F6\u95F4: "+M(l.row.createdate),1),m("p",ie,"\u6CE8\u518C\u6E20\u9053: "+M(l.row.channelName),1)])]),_:1}),a(p,{type:"index",label:"\u5E8F\u53F7",align:"center",width:"70",index:l=>(v.value.current-1)*v.value.size+l+1},null,8,["index"]),a(p,{prop:"realname",label:"\u59D3\u540D",align:"center",width:"100"}),a(p,{prop:"gender",label:"\u6027\u522B",width:"70",align:"center"},{default:t(l=>[f(M(l.row.gender==71?"\u7537":"\u5973"),1)]),_:1}),a(p,{prop:"idnumber",label:"\u8EAB\u4EFD\u8BC1",align:"center"}),a(p,{prop:"birthdate",label:"\u51FA\u751F\u65E5\u671F",align:"center"}),a(p,{prop:"phone",label:"\u624B\u673A\u53F7",align:"center"}),a(p,{prop:"cardtypeName",label:"\u5361\u7C7B\u578B",align:"center"}),a(p,{fixed:"right",label:"\u64CD\u4F5C",align:"center"},{default:t(l=>[a(g,{link:"",type:"primary",onClick:ee=>j(l.row)},{default:t(()=>e[31]||(e[31]=[f("\u7F16\u8F91")])),_:2,__:[31]},1032,["onClick"]),a(g,{link:"",type:"danger",onClick:ee=>K(l.row.id)},{default:t(()=>e[32]||(e[32]=[f("\u6CE8\u9500")])),_:2,__:[32]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[h,$.value]])]),_:1})]),_:1}),e[38]||(e[38]=m("div",{style:{"margin-top":"20px"}},null,-1)),a(F,null,{default:t(()=>[a(Y,{span:20},{default:t(()=>[a(W,{background:"",layout:"prev, pager, next",total:v.value.total,"page-count":v.value.pages,"current-page":B.value,"onUpdate:currentPage":e[3]||(e[3]=l=>B.value=l),onCurrentChange:X},null,8,["total","page-count","current-page"])]),_:1}),a(Y,{span:4},{default:t(()=>[a(_,{modelValue:q.value,"onUpdate:modelValue":e[4]||(e[4]=l=>q.value=l),class:"w-20 m-2",placeholder:"\u6BCF\u9875\u884C\u6570",onChange:e[5]||(e[5]=l=>V(1))},{default:t(()=>[(b(),U(x,null,R(L,l=>a(i,{key:l,label:l,value:l},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(P,{modelValue:c.value,"onUpdate:modelValue":e[15]||(e[15]=l=>c.value=l),title:"\u7F16\u8F91",onClose:e[16]||(e[16]=l=>T("edit"))},{footer:t(()=>[m("span",me,[a(g,{onClick:e[14]||(e[14]=l=>c.value=!1)},{default:t(()=>e[33]||(e[33]=[f("\u53D6\u6D88")])),_:1,__:[33]}),a(g,{type:"primary",onClick:G},{default:t(()=>e[34]||(e[34]=[f(" \u4FDD\u5B58 ")])),_:1,__:[34]})])]),default:t(()=>[a(z,{model:o.value,rules:A.value,ref_key:"editFormRef",ref:C,"label-width":"100px"},{default:t(()=>[a(d,{label:"\u5361\u53F7",prop:"cardNo"},{default:t(()=>[a(u,{modelValue:o.value.cardNo,"onUpdate:modelValue":e[6]||(e[6]=l=>o.value.cardNo=l),autocomplete:"off",disabled:""},null,8,["modelValue"])]),_:1}),a(d,{label:"\u59D3\u540D",prop:"realname"},{default:t(()=>[a(u,{modelValue:o.value.realname,"onUpdate:modelValue":e[7]||(e[7]=l=>o.value.realname=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(d,{label:"\u8EAB\u4EFD\u8BC1\u53F7",prop:"idnumber"},{default:t(()=>[a(u,{modelValue:o.value.idnumber,"onUpdate:modelValue":e[8]||(e[8]=l=>o.value.idnumber=l),autocomplete:"off",onBlur:r.getBirthDay},null,8,["modelValue","onBlur"])]),_:1}),a(d,{label:"\u51FA\u751F\u65E5\u671F",prop:"birthdate"},{default:t(()=>[a(u,{modelValue:o.value.birthdate,"onUpdate:modelValue":e[9]||(e[9]=l=>o.value.birthdate=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(d,{label:"\u6027\u522B",prop:"gender"},{default:t(()=>[a(_,{modelValue:o.value.gender,"onUpdate:modelValue":e[10]||(e[10]=l=>o.value.gender=l),placeholder:"\u8BF7\u9009\u62E9\u6027\u522B"},{default:t(()=>[a(i,{label:"\u7537",value:71}),a(i,{label:"\u5973",value:72})]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"\u624B\u673A\u53F7\u7801",prop:"phone"},{default:t(()=>[a(u,{modelValue:o.value.phone,"onUpdate:modelValue":e[11]||(e[11]=l=>o.value.phone=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(d,{label:"\u5BB6\u5EAD\u4F4F\u5740",prop:"addr"},{default:t(()=>[a(u,{modelValue:o.value.addr,"onUpdate:modelValue":e[12]||(e[12]=l=>o.value.addr=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(d,{label:"\u6CE8\u518C\u6E20\u9053",prop:"channel"},{default:t(()=>[a(_,{modelValue:o.value.channel,"onUpdate:modelValue":e[13]||(e[13]=l=>o.value.channel=l),placeholder:"\u8BF7\u9009\u62E9\u6CE8\u518C\u6E20\u9053"},{default:t(()=>[(b(!0),U(x,null,R(O.value,l=>(b(),N(i,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),a(P,{modelValue:y.value,"onUpdate:modelValue":e[27]||(e[27]=l=>y.value=l),title:"\u65B0\u589E\u5C31\u8BCA\u5361",onClose:e[28]||(e[28]=l=>T("add"))},{footer:t(()=>[m("span",fe,[a(g,{onClick:e[26]||(e[26]=l=>y.value=!1)},{default:t(()=>e[35]||(e[35]=[f("\u53D6\u6D88")])),_:1,__:[35]}),a(g,{type:"primary",onClick:H},{default:t(()=>e[36]||(e[36]=[f(" \u65B0\u589E ")])),_:1,__:[36]})])]),default:t(()=>[a(z,{model:o.value,rules:A.value,ref_key:"addFormRef",ref:w,"label-width":"100px"},{default:t(()=>[a(d,{label:"\u59D3\u540D",prop:"realname"},{default:t(()=>[a(u,{modelValue:o.value.realname,"onUpdate:modelValue":e[17]||(e[17]=l=>o.value.realname=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(d,{label:"\u8EAB\u4EFD\u8BC1\u53F7",prop:"idnumber"},{default:t(()=>[a(u,{modelValue:o.value.idnumber,"onUpdate:modelValue":e[18]||(e[18]=l=>o.value.idnumber=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(d,{label:"\u51FA\u751F\u65E5\u671F",prop:"birthdate"},{default:t(()=>[a(Z,{modelValue:o.value.birthdate,"onUpdate:modelValue":e[19]||(e[19]=l=>o.value.birthdate=l),type:"date",placeholder:"\u9009\u62E9\u4E00\u4E2A\u65E5\u671F",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),a(d,{label:"\u6027\u522B",prop:"gender"},{default:t(()=>[a(_,{modelValue:o.value.gender,"onUpdate:modelValue":e[20]||(e[20]=l=>o.value.gender=l),class:"m-2",placeholder:"\u8BF7\u9009\u62E9\u6027\u522B"},{default:t(()=>[a(i,{label:"\u7537",value:71}),a(i,{label:"\u5973",value:72})]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"\u5C31\u8BCA\u5361\u7C7B\u578B",prop:"cardtype"},{default:t(()=>[a(_,{modelValue:o.value.cardtype,"onUpdate:modelValue":e[21]||(e[21]=l=>o.value.cardtype=l),class:"m-2",placeholder:"\u8BF7\u9009\u62E9\u5361\u7C7B\u578B"},{default:t(()=>[a(i,{label:"\u666E\u901A",value:185}),a(i,{label:"\u533B\u4FDD\u5361",value:186})]),_:1},8,["modelValue"])]),_:1}),o.value.cardtype==186?(b(),N(d,{key:0,label:"\u533B\u4FDD\u5361\u53F7",prop:"cardNo"},{default:t(()=>[a(u,{modelValue:o.value.cardNo,"onUpdate:modelValue":e[22]||(e[22]=l=>o.value.cardNo=l),autocomplete:"off"},null,8,["modelValue"])]),_:1})):re("",!0),a(d,{label:"\u624B\u673A\u53F7\u7801",prop:"phone"},{default:t(()=>[a(u,{modelValue:o.value.phone,"onUpdate:modelValue":e[23]||(e[23]=l=>o.value.phone=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(d,{label:"\u5BB6\u5EAD\u4F4F\u5740",prop:"addr"},{default:t(()=>[a(u,{modelValue:o.value.addr,"onUpdate:modelValue":e[24]||(e[24]=l=>o.value.addr=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(d,{label:"\u6CE8\u518C\u6E20\u9053",prop:"channel"},{default:t(()=>[a(_,{modelValue:o.value.channel,"onUpdate:modelValue":e[25]||(e[25]=l=>o.value.channel=l),class:"m-2",placeholder:"\u8BF7\u9009\u62E9\u6CE8\u518C\u6E20\u9053"},{default:t(()=>[(b(!0),U(x,null,R(O.value,l=>(b(),N(i,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}};var _e=ae(ve,[["__scopeId","data-v-b061cbce"]]);export{_e as default};
