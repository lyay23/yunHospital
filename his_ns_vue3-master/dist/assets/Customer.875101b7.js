import{f as W,p as U}from"./api.12427e84.js";import{_ as Z,r as i,l as ee,s as le,m,b as n,c as ae,o as V,d as S,e as y,h as l,g as t,F as Y,i as c,w as te,f as q,t as oe,p as ne,E as re}from"./index.eaac7b27.js";const ue={class:"m-2"},se={class:"search-controls"},de={class:"dialog-footer"},ie={__name:"Customer",setup(pe){const $=i("first"),w=i(""),k=i(!1),p=i({records:[],total:0,pages:0,current:1,size:10}),C=i(1),g=i(!1),x=i(""),_=i(null),M={id:null,realName:"",gender:"",idnumber:"",birthdate:"",phone:"",channel:181},o=i(JSON.parse(JSON.stringify(M))),B={realName:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D",trigger:"blur"}],idnumber:[{required:!0,message:"\u8BF7\u8F93\u5165\u6709\u6548\u8EAB\u4EFD\u8BC1\u53F7\u7801",trigger:"blur"},{pattern:/^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,message:"\u8BF7\u8F93\u5165\u6709\u6548\u8EAB\u4EFD\u8BC1\u53F7\u7801",trigger:"blur"}],birthdate:[{required:!0,message:"\u8BF7\u9009\u62E9\u51FA\u751F\u65E5\u671F",trigger:"change"}],gender:[{required:!0,message:"\u8BF7\u9009\u62E9\u6027\u522B",trigger:"change"}],phone:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"\u8BF7\u8F93\u5165\u6709\u6548\u624B\u673A\u53F7",trigger:"blur"}],channel:[{required:!0,message:"\u8BF7\u9009\u62E9\u6CE8\u518C\u6E20\u9053",trigger:"change"}]},E=i([{value:181,label:"\u7A97\u53E3"},{value:182,label:"\u5FAE\u4FE1"},{value:183,label:"AndroidApp"},{value:184,label:"\u82F9\u679CApp"}]),F=(u,e)=>{};ee(()=>{b(1)});async function b(u){k.value=!0;const e=`/customer/page?count=${p.value.size}&pn=${u}&keyword=${w.value}`;try{const s=await W(e,null);s.result?p.value=s.data:s.errMsg==="\u672A\u767B\u5F55"&&le.push("/login")}catch{m.error("\u6570\u636E\u52A0\u8F7D\u5931\u8D25")}finally{k.value=!1}}function O(u){b(u)}function T(){_.value&&_.value.resetFields(),o.value=JSON.parse(JSON.stringify(M))}function A(){x.value="\u65B0\u589E\u7528\u6237",g.value=!0}function J(u){x.value="\u7F16\u8F91\u7528\u6237",o.value={...u},g.value=!0}async function z(){!_.value||await _.value.validate(async u=>{if(u){const e=!!o.value.id;if(!e){const r=new Date,v=r.getFullYear(),d=(r.getMonth()+1).toString().padStart(2,"0"),h=r.getDate().toString().padStart(2,"0");o.value.createdate=`${v}-${d}-${h}`}const s=e?"/customer/update":"/customer/add";try{const r=await U(s,o.value);if(r.data.result){g.value=!1;const v=e?p.value.current:1;e||(C.value=1),b(v),m.success(e?"\u4FEE\u6539\u6210\u529F":"\u65B0\u589E\u6210\u529F")}else m.error(r.data.errMsg||"\u64CD\u4F5C\u5931\u8D25")}catch{m.error("\u64CD\u4F5C\u5931\u8D25")}}})}function P(u){re.confirm("\u786E\u8BA4\u5220\u9664\u8BE5\u7528\u6237\u5417?","\u8B66\u544A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async()=>{try{const e=await U(`/customer/del/${u}`);e.data.result?(b(p.value.current),m.success("\u5220\u9664\u6210\u529F")):m.error(e.data.errMsg||"\u5220\u9664\u5931\u8D25")}catch{m.error("\u5220\u9664\u5931\u8D25")}})}return(u,e)=>{const s=n("el-input"),r=n("el-button"),v=n("el-row"),d=n("el-table-column"),h=n("el-table"),R=n("el-pagination"),I=n("el-col"),L=n("el-tab-pane"),X=n("el-tabs"),f=n("el-form-item"),j=n("el-date-picker"),N=n("el-option"),D=n("el-select"),G=n("el-form"),H=n("el-dialog"),K=ae("loading");return V(),S(Y,null,[y("div",ue,[l(X,{modelValue:$.value,"onUpdate:modelValue":e[3]||(e[3]=a=>$.value=a),class:"demo-tabs",onTabClick:F},{default:t(()=>[l(L,{label:"\u7528\u6237\u7BA1\u7406",name:"first"},{default:t(()=>[l(v,{class:"search-bar"},{default:t(()=>[y("div",se,[l(s,{modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=a=>w.value=a),modelModifiers:{trim:!0},placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D\u6216\u8EAB\u4EFD\u8BC1\u53F7"},null,8,["modelValue"]),l(r,{type:"primary",onClick:e[1]||(e[1]=a=>b(1))},{default:t(()=>e[12]||(e[12]=[c("\u67E5\u8BE2")])),_:1,__:[12]})]),l(r,{type:"primary",onClick:A},{default:t(()=>e[13]||(e[13]=[c("\u65B0\u589E\u7528\u6237")])),_:1,__:[13]})]),_:1}),e[16]||(e[16]=y("div",{style:{"margin-top":"40px"}},null,-1)),te((V(),q(h,{data:p.value.records,style:{width:"100%"}},{default:t(()=>[l(d,{type:"index",label:"\u5E8F\u53F7",align:"center",width:"70",index:a=>(p.value.current-1)*p.value.size+a+1},null,8,["index"]),l(d,{prop:"realName",label:"\u59D3\u540D",align:"center"}),l(d,{prop:"gender",label:"\u6027\u522B",align:"center"},{default:t(a=>[c(oe(a.row.gender==71?"\u7537":"\u5973"),1)]),_:1}),l(d,{prop:"idnumber",label:"\u8EAB\u4EFD\u8BC1",align:"center",width:"200"}),l(d,{prop:"birthdate",label:"\u51FA\u751F\u65E5\u671F",align:"center"}),l(d,{prop:"phone",label:"\u624B\u673A",align:"center"}),l(d,{prop:"createdate",label:"\u6CE8\u518C\u65E5\u671F",align:"center"}),l(d,{prop:"channelName",label:"\u6CE8\u518C\u6E20\u9053",align:"center"}),l(d,{fixed:"right",label:"\u64CD\u4F5C",align:"center",width:"150"},{default:t(a=>[l(r,{link:"",type:"primary",onClick:Q=>J(a.row)},{default:t(()=>e[14]||(e[14]=[c("\u7F16\u8F91")])),_:2,__:[14]},1032,["onClick"]),l(r,{link:"",type:"danger",onClick:Q=>P(a.row.id)},{default:t(()=>e[15]||(e[15]=[c("\u5220\u9664")])),_:2,__:[15]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[K,k.value]]),e[17]||(e[17]=y("div",{style:{"margin-top":"20px"}},null,-1)),l(v,null,{default:t(()=>[l(I,{span:20},{default:t(()=>[l(R,{background:"",layout:"prev, pager, next",total:p.value.total,"page-count":p.value.pages,"current-page":C.value,"onUpdate:currentPage":e[2]||(e[2]=a=>C.value=a),onCurrentChange:O},null,8,["total","page-count","current-page"])]),_:1})]),_:1})]),_:1,__:[16,17]})]),_:1},8,["modelValue"])]),l(H,{modelValue:g.value,"onUpdate:modelValue":e[11]||(e[11]=a=>g.value=a),title:x.value,width:"500px",onClose:T},{footer:t(()=>[y("span",de,[l(r,{onClick:e[10]||(e[10]=a=>g.value=!1)},{default:t(()=>e[18]||(e[18]=[c("\u53D6\u6D88")])),_:1,__:[18]}),l(r,{type:"primary",onClick:z},{default:t(()=>e[19]||(e[19]=[c("\u4FDD\u5B58")])),_:1,__:[19]})])]),default:t(()=>[l(G,{model:o.value,rules:B,ref_key:"formRef",ref:_,"label-width":"100px"},{default:t(()=>[l(f,{label:"\u59D3\u540D",prop:"realName"},{default:t(()=>[l(s,{modelValue:o.value.realName,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.realName=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(f,{label:"\u8EAB\u4EFD\u8BC1\u53F7",prop:"idnumber"},{default:t(()=>[l(s,{modelValue:o.value.idnumber,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.idnumber=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(f,{label:"\u51FA\u751F\u65E5\u671F",prop:"birthdate"},{default:t(()=>[l(j,{modelValue:o.value.birthdate,"onUpdate:modelValue":e[6]||(e[6]=a=>o.value.birthdate=a),type:"date",placeholder:"\u9009\u62E9\u4E00\u4E2A\u65E5\u671F",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),l(f,{label:"\u6027\u522B",prop:"gender"},{default:t(()=>[l(D,{modelValue:o.value.gender,"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.gender=a),placeholder:"\u8BF7\u9009\u62E9\u6027\u522B"},{default:t(()=>[l(N,{label:"\u7537",value:71}),l(N,{label:"\u5973",value:72})]),_:1},8,["modelValue"])]),_:1}),l(f,{label:"\u624B\u673A\u53F7\u7801",prop:"phone"},{default:t(()=>[l(s,{modelValue:o.value.phone,"onUpdate:modelValue":e[8]||(e[8]=a=>o.value.phone=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(f,{label:"\u6CE8\u518C\u6E20\u9053",prop:"channel"},{default:t(()=>[l(D,{modelValue:o.value.channel,"onUpdate:modelValue":e[9]||(e[9]=a=>o.value.channel=a),placeholder:"\u8BF7\u9009\u62E9\u6CE8\u518C\u6E20\u9053"},{default:t(()=>[(V(!0),S(Y,null,ne(E.value,a=>(V(),q(N,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])],64)}}};var ge=Z(ie,[["__scopeId","data-v-0ea4e880"]]);export{ge as default};
