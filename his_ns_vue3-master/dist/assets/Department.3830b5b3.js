import{f as J,p as P}from"./api.12427e84.js";import{_ as ae,r as d,l as te,b as s,c as oe,o as r,d as y,h as a,g as t,e as N,F as b,p as V,i as C,w as ne,f as _,m as B,E as z}from"./index.eaac7b27.js";const ue={class:"search-controls"},de={class:"dialog-footer"},re={class:"dialog-footer"},pe={__name:"Department",setup(se){const R=d(!1),m=d({}),x=d([]),$=d([]),c=d(""),U=d(""),T=d(""),q=d(10),K=[10,20,30,50],I=d(1),w=d(!1),D=d(!1),M=d(null),F=d(null),o=d({id:"",deptCode:"",deptName:"",deptCategoryID:"",deptType:""}),L=d({deptCategoryID:[{required:!0,message:"\u8BF7\u9009\u62E9\u79D1\u5BA4\u5206\u7C7B",trigger:"change"}],deptType:[{required:!0,message:"\u8BF7\u9009\u62E9\u79D1\u5BA4\u7C7B\u578B",trigger:"change"}],deptCode:[{required:!0,message:"\u8BF7\u8F93\u5165\u79D1\u5BA4\u7F16\u7801",trigger:"blur"}],deptName:[{required:!0,message:"\u8BF7\u8F93\u5165\u79D1\u5BA4\u540D\u79F0",trigger:"blur"}]});te(async()=>{p(1),j(1,1e3,x),j(12,1e3,$)});async function j(n,e,u){let i=`/constantitem/page?ctype=${n}&count=${e}&pn=1`;const v=await J(i,null);v.result?u.value=v.data.records:v.errMsg=="\u672A\u767B\u5F55"&&router.push("/login")}async function p(n){R.value=!0,I.value=n;let e=new URLSearchParams;e.append("pn",n),e.append("count",q.value),c.value&&e.append("keyword",c.value),U.value&&e.append("ctype",U.value),T.value&&e.append("dtype",T.value);const u=await J(`/department/page?${e.toString()}`,null);u.result?(m.value=u.data,R.value=!1):u.errMsg=="\u672A\u767B\u5F55"&&router.push("/login")}function O(n){p(n)}function Q(n){D.value=!0,o.value={...n}}function A(n){const e=n==="edit"?F.value:M.value;e&&e.resetFields(),o.value={id:"",deptCode:"",deptName:"",deptCategoryID:"",deptType:""}}async function W(){!F.value||await F.value.validate(n=>{n&&P("/department/update",o.value).then(e=>{e.data.result?(D.value=!1,p(m.value.current),B.success("\u4FEE\u6539\u6210\u529F")):B.error(e.data.errMsg||"\u4FEE\u6539\u5931\u8D25")})})}async function X(){!M.value||await M.value.validate(n=>{n&&P("/department/add",o.value).then(e=>{e.data.result?(w.value=!1,I.value=1,p(1),B.success("\u65B0\u589E\u6210\u529F")):B.error(e.data.errMsg||"\u65B0\u589E\u5931\u8D25")})})}function Y(n){z.confirm("\u786E\u8BA4\u662F\u5426\u5220\u9664?","\u8B66\u544A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{var e=new FormData;e.append("id",n),P("/department/del",e).then(u=>{u.data.result?(p(m.value.current),z.alert("\u5220\u9664\u6210\u529F","\u63D0\u793A",{})):(result.errMsg=="\u672A\u767B\u5F55"&&router.push("/login"),z.alert(u.data.errMsg,"\u63D0\u793A",{}))})})}return(n,e)=>{const u=s("el-option"),i=s("el-select"),v=s("el-input"),f=s("el-button"),E=s("el-row"),k=s("el-table-column"),Z=s("el-table"),S=s("el-col"),h=s("el-pagination"),g=s("el-form-item"),G=s("el-form"),H=s("el-dialog"),ee=oe("loading");return r(),y(b,null,[a(E,{class:"search-bar"},{default:t(()=>[N("div",ue,[a(i,{modelValue:T.value,"onUpdate:modelValue":e[0]||(e[0]=l=>T.value=l),filterable:"",clearable:"",onClear:e[1]||(e[1]=l=>p(1)),placeholder:"\u79D1\u5BA4\u7C7B\u578B",onChange:e[2]||(e[2]=l=>p(1))},{default:t(()=>[(r(!0),y(b,null,V($.value,l=>(r(),_(u,{key:l.id,label:l.constantCode+l.constantName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(i,{modelValue:U.value,"onUpdate:modelValue":e[3]||(e[3]=l=>U.value=l),filterable:"",clearable:"",onClear:e[4]||(e[4]=l=>p(1)),placeholder:"\u79D1\u5BA4\u5206\u7C7B",onChange:e[5]||(e[5]=l=>p(1))},{default:t(()=>[(r(!0),y(b,null,V(x.value,l=>(r(),_(u,{key:l.id,label:l.constantCode+l.constantName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(v,{modelValue:c.value,"onUpdate:modelValue":e[6]||(e[6]=l=>c.value=l),modelModifiers:{trim:!0},clearable:"",onClear:e[7]||(e[7]=l=>p(1)),placeholder:"\u8BF7\u8F93\u5165\u5E38\u6570\u9879\u7F16\u7801\u6216\u540D\u79F0"},null,8,["modelValue"]),a(f,{type:"primary",onClick:e[8]||(e[8]=l=>p(1))},{default:t(()=>e[27]||(e[27]=[C("\u67E5\u8BE2")])),_:1,__:[27]})]),a(f,{type:"primary",onClick:e[9]||(e[9]=l=>w.value=!0)},{default:t(()=>e[28]||(e[28]=[C("\u65B0\u589E\u79D1\u5BA4")])),_:1,__:[28]})]),_:1}),e[35]||(e[35]=N("div",{style:{"margin-top":"40px"}},null,-1)),a(E,{class:"m-2"},{default:t(()=>[a(S,{span:24},{default:t(()=>[ne((r(),_(Z,{data:m.value.records,style:{width:"100%"}},{default:t(()=>[a(k,{fixed:"",type:"index",label:"\u5E8F\u53F7",align:"center",width:"80",index:l=>(m.value.current-1)*m.value.size+l+1},null,8,["index"]),a(k,{prop:"deptCode",label:"\u79D1\u5BA4\u7F16\u7801",align:"center"}),a(k,{prop:"deptName",label:"\u79D1\u5BA4\u540D\u79F0",align:"center"}),a(k,{prop:"deptCategoryName",label:"\u79D1\u5BA4\u5206\u7C7B",align:"center"}),a(k,{prop:"deptTypeName",label:"\u79D1\u5BA4\u7C7B\u578B",align:"center"}),a(k,{fixed:"right",label:"\u64CD\u4F5C",align:"center"},{default:t(l=>[a(f,{link:"",type:"primary",onClick:le=>Q(l.row)},{default:t(()=>e[29]||(e[29]=[C("\u7F16\u8F91")])),_:2,__:[29]},1032,["onClick"]),a(f,{link:"",type:"danger",onClick:le=>Y(l.row.id)},{default:t(()=>e[30]||(e[30]=[C("\u5220\u9664")])),_:2,__:[30]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ee,R.value]])]),_:1})]),_:1}),e[36]||(e[36]=N("div",{style:{"margin-top":"20px"}},null,-1)),a(E,null,{default:t(()=>[a(S,{span:20},{default:t(()=>[a(h,{background:"",layout:"prev, pager, next",total:m.value.total,"page-count":m.value.pages,"current-page":I.value,"onUpdate:currentPage":e[10]||(e[10]=l=>I.value=l),onCurrentChange:O},null,8,["total","page-count","current-page"])]),_:1}),a(S,{span:4},{default:t(()=>[a(i,{modelValue:q.value,"onUpdate:modelValue":e[11]||(e[11]=l=>q.value=l),class:"w-20 m-2",placeholder:"\u6BCF\u9875\u884C\u6570",onChange:e[12]||(e[12]=l=>p(1))},{default:t(()=>[(r(),y(b,null,V(K,l=>a(u,{key:l,label:l,value:l},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(H,{modelValue:D.value,"onUpdate:modelValue":e[18]||(e[18]=l=>D.value=l),title:"\u7F16\u8F91",onClose:e[19]||(e[19]=l=>A("edit"))},{footer:t(()=>[N("span",de,[a(f,{onClick:e[17]||(e[17]=l=>D.value=!1)},{default:t(()=>e[31]||(e[31]=[C("\u53D6\u6D88")])),_:1,__:[31]}),a(f,{type:"primary",onClick:W},{default:t(()=>e[32]||(e[32]=[C(" \u4FDD\u5B58 ")])),_:1,__:[32]})])]),default:t(()=>[a(G,{model:o.value,rules:L.value,ref_key:"editFormRef",ref:F,"label-width":"100px"},{default:t(()=>[a(g,{label:"\u79D1\u5BA4\u5206\u7C7B",prop:"deptCategoryID"},{default:t(()=>[a(i,{modelValue:o.value.deptCategoryID,"onUpdate:modelValue":e[13]||(e[13]=l=>o.value.deptCategoryID=l),filterable:"",placeholder:"\u79D1\u5BA4\u5206\u7C7B"},{default:t(()=>[(r(!0),y(b,null,V(x.value,l=>(r(),_(u,{key:l.id,label:l.constantName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(g,{label:"\u79D1\u5BA4\u7C7B\u578B",prop:"deptType"},{default:t(()=>[a(i,{modelValue:o.value.deptType,"onUpdate:modelValue":e[14]||(e[14]=l=>o.value.deptType=l),filterable:"",placeholder:"\u79D1\u5BA4\u7C7B\u578B"},{default:t(()=>[(r(!0),y(b,null,V($.value,l=>(r(),_(u,{key:l.id,label:l.constantName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(g,{label:"\u79D1\u5BA4\u7F16\u7801",prop:"deptCode"},{default:t(()=>[a(v,{modelValue:o.value.deptCode,"onUpdate:modelValue":e[15]||(e[15]=l=>o.value.deptCode=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(g,{label:"\u79D1\u5BA4\u540D\u79F0",prop:"deptName"},{default:t(()=>[a(v,{modelValue:o.value.deptName,"onUpdate:modelValue":e[16]||(e[16]=l=>o.value.deptName=l),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),a(H,{modelValue:w.value,"onUpdate:modelValue":e[25]||(e[25]=l=>w.value=l),title:"\u65B0\u589E",onClose:e[26]||(e[26]=l=>A("add"))},{footer:t(()=>[N("span",re,[a(f,{onClick:e[24]||(e[24]=l=>w.value=!1)},{default:t(()=>e[33]||(e[33]=[C("\u53D6\u6D88")])),_:1,__:[33]}),a(f,{type:"primary",onClick:X},{default:t(()=>e[34]||(e[34]=[C(" \u65B0\u589E ")])),_:1,__:[34]})])]),default:t(()=>[a(G,{model:o.value,rules:L.value,ref_key:"addFormRef",ref:M,"label-width":"100px"},{default:t(()=>[a(g,{label:"\u79D1\u5BA4\u5206\u7C7B",prop:"deptCategoryID"},{default:t(()=>[a(i,{modelValue:o.value.deptCategoryID,"onUpdate:modelValue":e[20]||(e[20]=l=>o.value.deptCategoryID=l),filterable:"",placeholder:"\u79D1\u5BA4\u5206\u7C7B"},{default:t(()=>[(r(!0),y(b,null,V(x.value,l=>(r(),_(u,{key:l.id,label:l.constantName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(g,{label:"\u79D1\u5BA4\u7C7B\u578B",prop:"deptType"},{default:t(()=>[a(i,{modelValue:o.value.deptType,"onUpdate:modelValue":e[21]||(e[21]=l=>o.value.deptType=l),filterable:"",placeholder:"\u79D1\u5BA4\u7C7B\u578B"},{default:t(()=>[(r(!0),y(b,null,V($.value,l=>(r(),_(u,{key:l.id,label:l.constantName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(g,{label:"\u79D1\u5BA4\u7F16\u7801",prop:"deptCode"},{default:t(()=>[a(v,{modelValue:o.value.deptCode,"onUpdate:modelValue":e[22]||(e[22]=l=>o.value.deptCode=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(g,{label:"\u79D1\u5BA4\u540D\u79F0",prop:"deptName"},{default:t(()=>[a(v,{modelValue:o.value.deptName,"onUpdate:modelValue":e[23]||(e[23]=l=>o.value.deptName=l),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}};var me=ae(pe,[["__scopeId","data-v-93575f2a"]]);export{me as default};
