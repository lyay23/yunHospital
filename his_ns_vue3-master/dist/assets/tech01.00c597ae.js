import{g as $,p as z}from"./api.12427e84.js";import{_ as de,r as d,k as D,l as re,m as _,b as o,o as ie,f as pe,g as a,h as l,e as i,i as c,n as k,U as me,O as ce,a3 as _e,a4 as fe,a5 as ve,t as be}from"./index.eaac7b27.js";const ge=["src"],ye={class:"dialog-footer"},Ve={__name:"tech01",setup(we){const E=d(""),S=d([]),g=d({}),u=d({}),x=d([]),p=d([]),y=d(!1),q=d(null),N=d(""),A=d([]),V=d([]),F=d("/api/upload"),j=d({token:sessionStorage.getItem("token")||""}),M=d(""),h=d(!1),H=D(()=>p.value.length>0&&p.value.every(t=>t.state===2)),L=D(()=>p.value.length>0&&p.value.every(t=>t.state===4)),G=D(()=>p.value.length>0&&p.value.every(t=>t.state===4));re(()=>{P()});const P=async()=>{const t=new Date().toISOString().split("T")[0],e=await $(`/register/page?count=100&regDate=${t}`);e.status===200&&e.data.result?S.value=e.data.data.records.map(n=>({id:n.id,caseNumber:n.caseNumber,realName:n.realName,age:n.age})):_.error("\u67E5\u8BE2\u60A3\u8005\u5931\u8D25")},C=async t=>{if(!t)return;g.value=t;const e=await $(`/checkapply/getCheckApply?registId=${t.id}`);e.status===200&&e.data.result&&e.data.data&&e.data.data.checkApply?(u.value=e.data.data.checkApply,e.data.data.checkDetail?x.value=e.data.data.checkDetail.filter(n=>n.recordType===1):x.value=[]):(u.value={},x.value=[])},J=t=>{p.value=t},K=async()=>{const t=p.value.map(n=>n.id),e=await z("/checkapply/execute",t);e.status===200&&e.data.result?(_.success("\u6267\u884C\u6210\u529F"),C(g.value)):_.error(e.data.errMsg||"\u6267\u884C\u5931\u8D25")},Q=async()=>{const t=p.value.map(n=>n.id),e=await z("/checkapply/cancel-execute",t);e.status===200&&e.data.result?(_.success("\u53D6\u6D88\u6210\u529F"),C(g.value)):_.error(e.data.errMsg||"\u53D6\u6D88\u5931\u8D25")},W=()=>{N.value="",A.value=[],V.value=[],y.value=!0},X=async()=>{const t={checkApplyIds:p.value.map(n=>n.id),registId:g.value.id,resultDesc:N.value,resultImages:V.value.join(",")},e=await z("/checkapply/save-result",t);e.status===200&&e.data.result?(_.success("\u63D0\u4EA4\u7ED3\u679C\u6210\u529F"),y.value=!1,C(g.value)):_.error(e.data.errMsg||"\u63D0\u4EA4\u5931\u8D25")},Y=(t,e)=>{var f;const n=V.value.indexOf(((f=t.response)==null?void 0:f.data)||t.url);n>-1&&V.value.splice(n,1)},Z=t=>{M.value=t.url,h.value=!0},ee=(t,e,n)=>{if(t.result)V.value.push(t.data);else{_.error(t.errMsg||"\u56FE\u7247\u4E0A\u4F20\u5931\u8D25");const f=n.findIndex(U=>U.uid===e.uid);f>-1&&n.splice(f,1)}},R=t=>t===0?"\u5DF2\u4F5C\u5E9F":t===1?"\u6682\u5B58":t===2?"\u5DF2\u5F00\u7ACB":t===3?"\u5DF2\u6536\u8D39":t===4?"\u5DF2\u767B\u8BB0":t===5?"\u6267\u884C\u5B8C":t===6?"\u5DF2\u9000\u8D39":"\u672A\u77E5";return(t,e)=>{const n=o("el-input"),f=o("el-icon"),U=o("el-upload"),T=o("el-dialog"),b=o("el-button"),le=o("el-header"),B=o("el-tag"),m=o("el-table-column"),O=o("el-table"),ae=o("el-tab-pane"),te=o("el-tabs"),ne=o("el-main"),I=o("el-container"),se=o("el-aside"),r=o("el-col"),w=o("el-row"),v=o("el-form-item"),oe=o("el-form"),ue=o("el-divider");return ie(),pe(I,{style:{height:"100%",border:"1px solid #eee"}},{default:a(()=>[l(T,{title:"\u6DFB\u52A0\u68C0\u67E5\u7ED3\u679C",modelValue:y.value,"onUpdate:modelValue":e[3]||(e[3]=s=>y.value=s),width:"50%"},{footer:a(()=>[i("span",ye,[l(b,{onClick:e[2]||(e[2]=s=>y.value=!1),size:"small"},{default:a(()=>e[11]||(e[11]=[c("\u53D6 \u6D88")])),_:1,__:[11]}),l(b,{style:{"margin-left":"10px"},size:"small",type:"success",onClick:X},{default:a(()=>e[12]||(e[12]=[c("\u63D0 \u4EA4")])),_:1,__:[12]})])]),default:a(()=>[e[13]||(e[13]=i("span",null,"\u7ED3\u679C\u63CF\u8FF0\uFF1A",-1)),l(n,{modelValue:N.value,"onUpdate:modelValue":e[0]||(e[0]=s=>N.value=s),placeholder:"\u8BF7\u8F93\u5165\u7ED3\u679C\u63CF\u8FF0",type:"textarea",rows:"3",class:"input-with-select",style:{width:"100%"}},null,8,["modelValue"]),e[14]||(e[14]=i("br",null,null,-1)),e[15]||(e[15]=i("br",null,null,-1)),e[16]||(e[16]=i("span",null,"\u7ED3\u679C\u56FE\u7247\uFF1A",-1)),l(U,{ref_key:"upload",ref:q,action:F.value,"list-type":"picture-card","on-preview":Z,"on-remove":Y,"on-success":ee,"file-list":A.value,multiple:!0,headers:j.value},{default:a(()=>[l(f,null,{default:a(()=>[l(k(me))]),_:1})]),_:1},8,["action","file-list","headers"]),l(T,{modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=s=>h.value=s)},{default:a(()=>[i("img",{"w-full":"",src:M.value,alt:"Preview Image",style:{width:"100%"}},null,8,ge)]),_:1},8,["modelValue"])]),_:1,__:[13,14,15,16]},8,["modelValue"]),l(se,{width:"350px",class:"aside-card"},{default:a(()=>[l(I,null,{default:a(()=>[l(le,{class:"search-header"},{default:a(()=>[l(n,{placeholder:"\u8BF7\u8F93\u5165\u75C5\u5386\u53F7/\u59D3\u540D",modelValue:E.value,"onUpdate:modelValue":e[4]||(e[4]=s=>E.value=s),class:"input-with-select search-input",style:{width:"100%"}},{prepend:a(()=>e[17]||(e[17]=[c("\u60A3\u8005\u67E5\u8BE2\uFF1A")])),append:a(()=>[l(b,{icon:k(ce),onClick:P},null,8,["icon"])]),_:1},8,["modelValue"])]),_:1}),l(ne,{class:"patient-list-main",style:{height:"700px",border:"1px solid #eee",padding:"0",margin:"0"}},{default:a(()=>[l(te,{type:"border-card"},{default:a(()=>[l(ae,{label:"\u60A3\u8005\u68C0\u67E5"},{default:a(()=>[l(B,null,{default:a(()=>e[18]||(e[18]=[c("\u60A3\u8005\uFF1A")])),_:1,__:[18]}),l(O,{ref:"singleTable",data:S.value,"highlight-current-row":"",onCurrentChange:C,style:{width:"100%"},"show-header":!1,size:"mini",class:"patient-table"},{default:a(()=>[l(m,{property:"caseNumber",label:"\u75C5\u5386\u53F7"}),l(m,{property:"realName",label:"\u59D3\u540D",width:"80"}),l(m,{property:"id",label:"id",width:"100"})]),_:1},8,["data"]),e[19]||(e[19]=i("br",null,null,-1)),e[20]||(e[20]=i("br",null,null,-1))]),_:1,__:[19,20]})]),_:1})]),_:1})]),_:1})]),_:1}),l(I,{direction:"vertical",class:"main-card",style:{height:"100%"}},{default:a(()=>[l(w,{style:{"background-color":"#EAF1F5"}},{default:a(()=>[l(r,{span:9,style:{"margin-top":"4px"}},{default:a(()=>[l(B,{size:"mini"},{default:a(()=>e[21]||(e[21]=[c("\u68C0\u67E5\u660E\u7EC6\u4FE1\u606F\uFF1A")])),_:1,__:[21]})]),_:1}),l(r,{span:5},{default:a(()=>[l(b,{type:"text",size:"small",icon:k(_e),onClick:K,disabled:!H.value},{default:a(()=>e[22]||(e[22]=[c("\u6267\u884C\u786E\u8BA4")])),_:1,__:[22]},8,["icon","disabled"])]),_:1}),l(r,{span:5},{default:a(()=>[l(b,{type:"text",size:"small",icon:k(fe),onClick:Q,disabled:!L.value},{default:a(()=>e[23]||(e[23]=[c("\u53D6\u6D88\u6267\u884C")])),_:1,__:[23]},8,["icon","disabled"])]),_:1}),l(r,{span:5},{default:a(()=>[l(b,{type:"text",size:"small",icon:k(ve),onClick:W,disabled:!G.value},{default:a(()=>e[24]||(e[24]=[c("\u586B\u5199\u7ED3\u679C")])),_:1,__:[24]},8,["icon","disabled"])]),_:1})]),_:1}),l(oe,{ref:"form",model:u.value,"label-width":"80px",size:"mini",inline:!0,class:"detail-form"},{default:a(()=>[l(w,null,{default:a(()=>e[25]||(e[25]=[i("div",{style:{"font-size":"large","text-align":"center"}},"\u68C0\u67E5\u660E\u7EC6\u5355",-1),i("hr",null,null,-1)])),_:1,__:[25]}),l(w,null,{default:a(()=>[l(r,{span:6},{default:a(()=>[l(v,{label:"\u75C5\u5386\u53F7:"},{default:a(()=>[l(n,{modelValue:u.value.caseNumber,"onUpdate:modelValue":e[5]||(e[5]=s=>u.value.caseNumber=s),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),l(r,{span:6},{default:a(()=>[l(v,{label:"\u60A3\u8005\u59D3\u540D:"},{default:a(()=>[l(n,{modelValue:u.value.realName,"onUpdate:modelValue":e[6]||(e[6]=s=>u.value.realName=s),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),l(r,{span:6},{default:a(()=>[l(v,{label:"\u5E74\u9F84:"},{default:a(()=>[l(n,{modelValue:u.value.age,"onUpdate:modelValue":e[7]||(e[7]=s=>u.value.age=s),readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(w,null,{default:a(()=>[l(r,{span:6},{default:a(()=>[l(v,{label:"\u5C31\u8BCA\u79D1\u5BA4:"},{default:a(()=>[l(n,{modelValue:u.value.deptName,"onUpdate:modelValue":e[8]||(e[8]=s=>u.value.deptName=s),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),l(r,{span:6},{default:a(()=>[l(v,{label:"\u5904\u65B9\u72B6\u6001:"},{default:a(()=>[l(n,{value:R(u.value.state),readonly:""},null,8,["value"])]),_:1})]),_:1})]),_:1}),l(w,null,{default:a(()=>[l(r,{span:6},{default:a(()=>[l(v,{label:"\u6536\u8D39\u65E5\u671F:"},{default:a(()=>[l(n,{modelValue:u.value.registTime,"onUpdate:modelValue":e[9]||(e[9]=s=>u.value.registTime=s),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),l(r,{span:6},{default:a(()=>[l(v,{label:"\u5F00\u5355\u533B\u751F:"},{default:a(()=>[l(n,{modelValue:u.value.doctorName,"onUpdate:modelValue":e[10]||(e[10]=s=>u.value.doctorName=s),readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),l(ue,{"content-position":"left"},{default:a(()=>e[26]||(e[26]=[c("\u68C0\u67E5\u4FE1\u606F:")])),_:1,__:[26]}),l(O,{data:x.value,stripe:"",style:{width:"100%"},onSelectionChange:J,class:"detail-table"},{default:a(()=>[l(m,{type:"selection",width:"55"}),l(m,{prop:"itemName",label:"\u68C0\u67E5\u540D\u79F0"}),l(m,{prop:"position",label:"\u68C0\u67E5\u90E8\u4F4D"}),l(m,{prop:"num",label:"\u6570\u91CF"}),l(m,{prop:"price",label:"\u5355\u4EF7"}),l(m,{prop:"totalAmount",label:"\u603B\u91D1\u989D"}),l(m,{prop:"state",label:"\u72B6\u6001"},{default:a(s=>[i("span",null,be(R(s.row.state)),1)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})}}};var Ne=de(Ve,[["__scopeId","data-v-7f5e0a1e"]]);export{Ne as default};
